<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
</head>
<body>
	<canvas id="loadingCanvas" style="position:absolute;left:30px;top:30px;border:1px solid" width="600px" height='600px'></canvas>
	
	<script src="./jquery-1.7.1.js"></script>
	<script type="text/javascript">
	//2014年2月14 加载数据的等待效果
	//为了尽快出现加载等待效果，不是很多的数据就直接放页面
	var LoadingCastData = [{"x":149,"y":209},{"x":149,"y":210},{"x":149,"y":211},{"x":149,"y":212},{"x":149,"y":213},{"x":149,"y":214},{"x":149,"y":215},{"x":149,"y":216},{"x":149,"y":217},
	{"x":149,"y":218},{"x":149,"y":219},{"x":149,"y":220},{"x":149,"y":221},{"x":149,"y":222},{"x":149,"y":223},{"x":149,"y":224},{"x":149,"y":225},{"x":149,"y":226},{"x":150,"y":226},
	{"x":150,"y":227},{"x":150,"y":228},{"x":152,"y":212},{"x":153,"y":212},{"x":154,"y":212},{"x":155,"y":212},{"x":156,"y":212},{"x":157,"y":212},{"x":158,"y":212},{"x":159,"y":212},
	{"x":160,"y":212},{"x":161,"y":212},{"x":161,"y":213},{"x":161,"y":214},{"x":160,"y":215},{"x":160,"y":216},{"x":159,"y":217},{"x":159,"y":218},{"x":159,"y":219},{"x":159,"y":220},
	{"x":159,"y":221},{"x":159,"y":222},{"x":159,"y":223},{"x":159,"y":224},{"x":159,"y":225},{"x":159,"y":226},{"x":159,"y":227},{"x":152,"y":225},{"x":153,"y":225},{"x":154,"y":225},
	{"x":155,"y":225},{"x":156,"y":225},{"x":157,"y":225},{"x":158,"y":225},{"x":169,"y":203},{"x":170,"y":203},{"x":171,"y":203},{"x":172,"y":203},{"x":173,"y":203},{"x":174,"y":203},
	{"x":175,"y":203},{"x":176,"y":203},{"x":177,"y":203},{"x":178,"y":203},{"x":179,"y":203},{"x":180,"y":203},{"x":181,"y":203},{"x":182,"y":203},{"x":182,"y":204},{"x":183,"y":204},
	{"x":184,"y":204},{"x":185,"y":204},{"x":186,"y":204},{"x":171,"y":206},{"x":171,"y":207},{"x":171,"y":208},{"x":171,"y":209},{"x":171,"y":210},{"x":171,"y":211},{"x":171,"y":212},
	{"x":171,"y":213},{"x":171,"y":214},{"x":171,"y":215},{"x":171,"y":216},{"x":171,"y":217},{"x":171,"y":218},{"x":171,"y":219},{"x":171,"y":220},{"x":171,"y":221},{"x":171,"y":222},
	{"x":171,"y":223},{"x":171,"y":224},{"x":171,"y":225},{"x":171,"y":226},{"x":171,"y":227},{"x":171,"y":228},{"x":171,"y":229},{"x":170,"y":229},{"x":170,"y":230},{"x":170,"y":231},
	{"x":169,"y":231},{"x":169,"y":232},{"x":169,"y":233},{"x":168,"y":233},{"x":168,"y":234},{"x":167,"y":234},{"x":167,"y":235},{"x":166,"y":235},{"x":166,"y":236},{"x":165,"y":236},
	{"x":165,"y":237},{"x":164,"y":237},{"x":164,"y":238},{"x":163,"y":238},{"x":162,"y":238},{"x":162,"y":239},{"x":161,"y":239},{"x":178,"y":214},{"x":179,"y":214},{"x":180,"y":214},
	{"x":181,"y":214},{"x":182,"y":214},{"x":183,"y":214},{"x":184,"y":214},{"x":185,"y":214},{"x":186,"y":214},{"x":187,"y":214},{"x":188,"y":214},{"x":189,"y":214},{"x":189,"y":215},
	{"x":189,"y":216},{"x":189,"y":217},{"x":189,"y":218},{"x":189,"y":219},{"x":189,"y":220},{"x":189,"y":221},{"x":188,"y":222},{"x":187,"y":222},{"x":187,"y":223},{"x":186,"y":223},
	{"x":185,"y":223},{"x":179,"y":218},{"x":179,"y":219},{"x":180,"y":219},{"x":180,"y":220},{"x":180,"y":221},{"x":180,"y":222},{"x":180,"y":223},{"x":180,"y":224},{"x":180,"y":225},
	{"x":180,"y":226},{"x":180,"y":227},{"x":180,"y":228},{"x":180,"y":229},{"x":180,"y":230},{"x":180,"y":231},{"x":180,"y":232},{"x":181,"y":232},{"x":181,"y":233},{"x":182,"y":234},
	{"x":183,"y":234},{"x":184,"y":234},{"x":184,"y":235},{"x":185,"y":235},{"x":186,"y":235},{"x":187,"y":235},{"x":188,"y":235},{"x":189,"y":235},{"x":190,"y":235},{"x":191,"y":235},
	{"x":192,"y":235},{"x":193,"y":235},{"x":194,"y":235},{"x":195,"y":235},{"x":195,"y":234},{"x":195,"y":233},{"x":195,"y":232},{"x":196,"y":232},{"x":196,"y":231},{"x":215,"y":215},
	{"x":216,"y":215},{"x":216,"y":216},{"x":241,"y":215},{"x":242,"y":215},{"x":242,"y":216},{"x":267,"y":215},{"x":268,"y":215},{"x":268,"y":216},{"x":269,"y":216}]
	var LineX = [210,230,260,280];//三段划分线区分点数据，方便动态显示
	var NowIndex = 0;
	var ShowingCastData;//正在展示的数据
	var LoadingCanvas;//画布
	var LoadingContext;//画布上下文
	var Times = 500;//速率
	var LineWidth = 3;//线粗细
	var Interval;
	$(window).ready(function(){
		//模拟“载入中”等待效果
		LoadingCanvas=document.querySelector('#loadingCanvas');
		LoadingContext=LoadingCanvas.getContext('2d');
		Interval = setInterval(loading,Times);
		//进行异步加载数据，并设置为Html5的LocalStorage,返回的时候停止定时器，并跳转到展示页面
		
	});
	//显示加载效果
	function loading(){
		getLoadingCastData();
		LoadingContext.clearRect(0, 0, LoadingCanvas.width, LoadingCanvas.height);  //清屏
		LoadingContext.save();   
		LoadingContext.beginPath();
		//正式展现
		for(var i=0;i<ShowingCastData.length;i++){
			LoadingContext.fillRect(ShowingCastData[i].x,ShowingCastData[i].y,LineWidth,LineWidth);
		}
		LoadingContext.stroke();
		LoadingContext.closePath();
		LoadingContext.restore();   
	}
	//获得加载数据
	function getLoadingCastData(){
		ShowingCastData = new Array();
		if(NowIndex>=LineX.length){
			NowIndex = 0;//从头开始计数
		}
		for(var i=0;i<LoadingCastData.length;i++){
			if(LoadingCastData[i].x<=LineX[NowIndex]){
				ShowingCastData.push(LoadingCastData[i]);
			}
		}
		NowIndex++;
	}
	</script>
</body>
</html>